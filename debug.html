<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Main App Debug</title>
  <style>
    body { font-family: monospace; padding: 20px; }
    .log { margin: 5px 0; }
    .error { color: red; }
    .success { color: green; }
    .info { color: blue; }
  </style>
</head>
<body>
  <h1>Main App Debug Console</h1>
  <button id="clearDb">Clear Database</button>
  <button id="testLogin">Test Login Flow</button>
  <div id="logs"></div>

  <script>
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;
    
    function addLog(msg, type = 'info') {
      const div = document.createElement('div');
      div.className = 'log ' + type;
      div.textContent = new Date().toLocaleTimeString() + ' - ' + msg;
      document.getElementById('logs').appendChild(div);
    }
    
    console.log = function(...args) {
      originalLog.apply(console, args);
      addLog(args.join(' '), 'info');
    };
    
    console.error = function(...args) {
      originalError.apply(console, args);
      addLog('ERROR: ' + args.join(' '), 'error');
    };
    
    console.warn = function(...args) {
      originalWarn.apply(console, args);
      addLog('WARN: ' + args.join(' '), 'info');
    };

    document.getElementById('clearDb').addEventListener('click', async () => {
      try {
        await indexedDB.deleteDatabase('inventory2');
        addLog('✅ Database cleared', 'success');
        setTimeout(() => location.reload(), 500);
      } catch (e) {
        addLog('❌ Failed to clear DB: ' + e.message, 'error');
      }
    });

    document.getElementById('testLogin').addEventListener('click', () => {
      addLog('Opening main app...', 'info');
      window.open('index.html', '_blank');
    });

    window.addEventListener('error', (e) => {
      addLog('GLOBAL ERROR: ' + e.message + ' at ' + e.filename + ':' + e.lineno, 'error');
    });

    addLog('Debug console ready. Open DevTools Console for full output.', 'success');
  </script>
  
  <script src="app.js?v=20251116"></script>
</body>
</html>
